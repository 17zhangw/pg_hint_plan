LOAD 'pg_hint_plan';
SET pg_hint_plan.enable TO on;
SET pg_hint_plan.debug_print TO on;
SET search_path TO public;
----
---- No. G-2-2 category of GUC parameter and role
----
-- No. G-2-2-1
SET ROLE super_user;
/*+Set(block_size 16384)*/
SELECT * FROM s1.t1 WHERE t1.c1 = 1;
INFO:  parameter "block_size" cannot be changed
 c1 | c2 | c3 | c4 
----+----+----+----
  1 |  1 |  1 | 1
(1 row)

-- No. G-2-2-2
/*+Set(archive_mode off)*/
SELECT * FROM s1.t1 WHERE t1.c1 = 1;
INFO:  parameter "archive_mode" cannot be changed without restarting the server
 c1 | c2 | c3 | c4 
----+----+----+----
  1 |  1 |  1 | 1
(1 row)

-- No. G-2-2-3
/*+Set(archive_timeout 0)*/
SELECT * FROM s1.t1 WHERE t1.c1 = 1;
INFO:  parameter "archive_timeout" cannot be changed now
 c1 | c2 | c3 | c4 
----+----+----+----
  1 |  1 |  1 | 1
(1 row)

-- No. G-2-2-4
/*+Set(log_connections off)*/
SELECT * FROM s1.t1 WHERE t1.c1 = 1;
INFO:  parameter "log_connections" cannot be set after connection start
 c1 | c2 | c3 | c4 
----+----+----+----
  1 |  1 |  1 | 1
(1 row)

-- No. G-2-2-5
/*+Set(log_min_messages WARNING)*/
SELECT * FROM s1.t1 WHERE t1.c1 = 1;
 c1 | c2 | c3 | c4 
----+----+----+----
  1 |  1 |  1 | 1
(1 row)

RESET ROLE;
-- No. G-2-2-6
GRANT ALL ON SCHEMA s1 TO PUBLIC;
GRANT SELECT ON ALL TABLES IN SCHEMA s1 TO normal_user;
SET ROLE normal_user;
/*+Set(log_min_messages WARNING)*/
SELECT * FROM s1.t1 WHERE t1.c1 = 1;
INFO:  permission denied to set parameter "log_min_messages"
 c1 | c2 | c3 | c4 
----+----+----+----
  1 |  1 |  1 | 1
(1 row)

-- No. G-2-2-7
/*+Set(enable_seqscan on)*/
SELECT * FROM s1.t1 WHERE t1.c1 = 1;
 c1 | c2 | c3 | c4 
----+----+----+----
  1 |  1 |  1 | 1
(1 row)

RESET ROLE;
REVOKE SELECT ON ALL TABLES IN SCHEMA s1 FROM normal_user;
REVOKE ALL ON SCHEMA s1 FROM PUBLIC;
----
---- No. G-2-3 conflict set hint
----
SET client_min_messages TO LOG;
-- No. G-2-3-1
/*+Set(enable_indexscan on)Set(enable_indexscan off)*/
SELECT * FROM s1.t1 WHERE false;
INFO:  hint syntax error at or near "Set(enable_indexscan on)Set(enable_indexscan off)"
DETAIL:  Conflict set hint.
LOG:  pg_hint_plan:
used hint:
Set(enable_indexscan off)
not used hint:
duplication hint:
Set(enable_indexscan on)
error hint:

 c1 | c2 | c3 | c4 
----+----+----+----
(0 rows)

-- No. G-2-3-2
/*+Set(client_min_messages DEBUG5)Set(client_min_messages WARNING)Set(client_min_messages DEBUG2)*/
SELECT * FROM s1.t1 WHERE false;
INFO:  hint syntax error at or near "Set(client_min_messages DEBUG5)Set(client_min_messages WARNING)Set(client_min_messages DEBUG2)"
DETAIL:  Conflict set hint.
INFO:  hint syntax error at or near "Set(client_min_messages WARNING)Set(client_min_messages DEBUG2)"
DETAIL:  Conflict set hint.
LOG:  pg_hint_plan:
used hint:
Set(client_min_messages DEBUG2)
not used hint:
duplication hint:
Set(client_min_messages DEBUG5)
Set(client_min_messages WARNING)
error hint:

 c1 | c2 | c3 | c4 
----+----+----+----
(0 rows)

-- No. G-2-3-3
/*+Set(enable_indexscan on)Set(enable_indexscan o)*/
SELECT * FROM s1.t1 WHERE false;
INFO:  hint syntax error at or near "Set(enable_indexscan on)Set(enable_indexscan o)"
DETAIL:  Conflict set hint.
INFO:  parameter "enable_indexscan" requires a Boolean value
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
Set(enable_indexscan on)
error hint:
Set(enable_indexscan o)

 c1 | c2 | c3 | c4 
----+----+----+----
(0 rows)

-- No. G-2-3-4
/*+Set(client_min_messages DEBUG5)Set(client_min_messages WARNING)Set(client_min_messages DEBU)*/
SELECT * FROM s1.t1 WHERE false;
INFO:  hint syntax error at or near "Set(client_min_messages DEBUG5)Set(client_min_messages WARNING)Set(client_min_messages DEBU)"
DETAIL:  Conflict set hint.
INFO:  hint syntax error at or near "Set(client_min_messages WARNING)Set(client_min_messages DEBU)"
DETAIL:  Conflict set hint.
INFO:  invalid value for parameter "client_min_messages": "DEBU"
HINT:  Available values: debug5, debug4, debug3, debug2, debug1, log, notice, warning, error.
LOG:  pg_hint_plan:
used hint:
not used hint:
duplication hint:
Set(client_min_messages DEBUG5)
Set(client_min_messages WARNING)
error hint:
Set(client_min_messages DEBU)

 c1 | c2 | c3 | c4 
----+----+----+----
(0 rows)

----
---- No. G-2-4 debug message
----
-- No. G-2-4-1
/*+SeqScan(a)IndexScan(a)SeqScan(c)NestLoop(a) */
SELECT * FROM s1.t1 a, s1.t2 b WHERE false;
INFO:  hint syntax error at or near ") "
DETAIL:  Specified relation more than two.
INFO:  hint syntax error at or near "SeqScan(a)IndexScan(a)SeqScan(c)NestLoop(a) "
DETAIL:  Conflict scan method hint.
LOG:  pg_hint_plan:
used hint:
IndexScan(a)
not used hint:
SeqScan(c)
duplication hint:
SeqScan(a)
error hint:
NestLoop(a)

 c1 | c2 | c3 | c4 | c1 | c2 | c3 | c4 
----+----+----+----+----+----+----+----
(0 rows)

